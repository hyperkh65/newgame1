<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>SNAPPLUG OS - INTELLIGENT ENGINE v16</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono&display=swap');
        :root { --p-blue: #0070f3; --p-green: #10b981; --p-red: #ef4444; --p-bg: #030407; --p-border: rgba(255,255,255,0.08); }
        body, html { margin:0; padding:0; background: var(--p-bg); color: #fff; font-family: 'Inter', sans-serif; height: 100vh; overflow: hidden; }
        
        /* Dashboard Framework */
        #app-root { display: grid; grid-template-columns: 240px 1fr 340px; height: 100vh; }
        
        aside { background: #0d1017; border-right: 1px solid var(--p-border); padding: 24px 16px; }
        main { position: relative; background: radial-gradient(circle at 50% 20%, #0d1626 0%, #030407 100%); }
        #chat-panel { background: rgba(13, 16, 23, 0.98); border-left: 1px solid var(--p-border); display: flex; flex-direction: column; backdrop-filter: blur(40px); }

        /* Real-time Status UI */
        .node-status { font-family: 'JetBrains Mono', monospace; font-size: 11px; padding: 4px 8px; border-radius: 4px; background: rgba(0,0,0,0.5); border: 1px solid var(--p-border); margin-bottom: 12px; display: inline-block; }
        .pulse { display: inline-block; width: 6px; height: 6px; border-radius: 50%; background: var(--p-blue); margin-right: 8px; box-shadow: 0 0 10px var(--p-blue); }

        /* Terminal Bar */
        #cmd-bar { position: absolute; bottom: 32px; left: 50%; transform: translateX(-50%); width: 600px; height: 52px; background: #161a20; border: 1px solid var(--p-border); border-radius: 12px; display: flex; align-items: center; padding: 0 16px; box-shadow: 0 30px 60px rgba(0,0,0,0.8); z-index: 1000; }
        #cmd-input { flex: 1; background: transparent; border: none; outline: none; color: #fff; font-size: 14px; margin-left: 14px; }
    </style>
</head>
<body>
    <div id="app-root">
        <aside>
            <div style="font-weight:700; margin-bottom:32px; font-size:20px;">⚡ SNAPPLUG</div>
            <div style="font-size:12px; color:#555; font-weight:700; margin-bottom:12px">PLUGINS</div>
            <div id="plugin-status" style="font-size:13px; color:#888;">Connecting to Shopify...</div>
        </aside>

        <main id="viewport-container">
            <header style="padding: 20px 40px; border-bottom: 1px solid var(--p-border); display: flex; justify-content: space-between; align-items: center; position: relative; z-index: 10;">
                <div style="font-size:14px; color:#888;">Workflows / <span style="color:#fff">AI Revenue Analytics</span></div>
                <div class="node-status"><span class="pulse"></span> ENGINE CORE: OPTIMAL</div>
            </header>
            <section id="viewport" style="position: absolute; top:0; left:0; width:100%; height:100%;"></section>
            
            <div id="cmd-bar">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#0070f3" stroke-width="2.5"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                <input type="text" id="cmd-input" placeholder="커맨드를 입력하여 지능형 에이전트를 구동하세요...">
            </div>
        </main>

        <div id="chat-panel">
            <div style="padding:20px; border-bottom:1px solid var(--p-border); font-weight:600;">Thread Insight</div>
            <div id="thread-content" style="flex:1; padding:20px; font-size:14px; line-height:1.6; color:#aaa; overflow-y:auto;">
                <div style="background:rgba(255,255,255,0.03); padding:15px; border-radius:12px; border-left:3px solid var(--p-blue);">
                    <b>System Analysis</b><br>
                    데이터 동기화 완료. Shopify 매출 데이터와 Slack 채널 알림 자동화 워크플로우를 분석 중입니다.
                </div>
            </div>
            <div style="padding:20px; border-top:1px solid var(--p-border);">
                <input id="chat-msg" type="text" placeholder="메시지 전송..." style="width:100%; background:transparent; border:1px solid var(--p-border); padding:12px; color:#fff; border-radius:10px; outline:none;">
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        // --- PRO-GRADE INTELLIGENT ENGINE (Core Logic) ---
        class SnapEngine {
            constructor() {
                this.initScene();
                this.initNodes();
                this.bindEvents();
                this.animate();
                console.log("SnapPlug Engine Core v16 Online.");
            }

            initScene() {
                this.container = document.getElementById('viewport');
                this.scene = new THREE.Scene();
                this.camera = new THREE.PerspectiveCamera(50, this.container.clientWidth / this.container.clientHeight, 0.1, 1000);
                this.renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
                this.renderer.setSize(this.container.clientWidth, this.container.clientHeight);
                this.container.appendChild(this.renderer.domElement);
                
                this.scene.add(new THREE.AmbientLight(0xffffff, 0.2));
                const glow = new THREE.PointLight(0x0070f3, 2, 50);
                glow.position.set(5, 5, 10);
                this.scene.add(glow);
                this.camera.position.set(0, 5, 15);
            }

            initNodes() {
                this.nodes = [];
                const roles = [
                    { name: 'Data Fetcher', color: 0x0070f3, x: -5, y: 2 },
                    { name: 'AI Processor', color: 0x10b981, x: 0, y: -1 },
                    { name: 'Slack Notifier', color: 0xf43f5e, x: 5, y: 1 }
                ];

                roles.forEach(r => {
                    const group = new THREE.Group();
                    const core = new THREE.Mesh(
                        new THREE.IcosahedronGeometry(0.8, 1),
                        new THREE.MeshPhongMaterial({ color: r.color, wireframe: true, transparent: true, opacity: 0.7 })
                    );
                    group.add(core);
                    group.position.set(r.x, r.y, 0);
                    group.userData = { ...r, status: 'IDLE', offset: Math.random()*10 };
                    this.scene.add(group);
                    this.nodes.push(group);
                });

                // Connect with Animated Energy Lines
                const mat = new THREE.LineBasicMaterial({ color: 0x0070f3, transparent: true, opacity: 0.2 });
                const points = this.nodes.map(n => n.position);
                const geo = new THREE.BufferGeometry().setFromPoints(points);
                this.scene.add(new THREE.Line(geo, mat));
            }

            triggerAction(agentName, action) {
                const node = this.nodes.find(n => n.userData.name.includes(agentName));
                if (node) {
                    node.userData.status = 'PROCESSING';
                    this.addLog(`<b>${agentName}</b>: ${action} 실행 중...`, 'blue');
                    // Logic Simulation
                    setTimeout(() => {
                        node.userData.status = 'SUCCESS';
                        this.addLog(`<b>${agentName}</b>: 업무가 성공적으로 처리되었습니다.`, 'green');
                    }, 2000);
                }
            }

            addLog(msg, color) {
                const content = document.getElementById('thread-content');
                const div = document.createElement('div');
                div.style.cssText = `margin-top:15px; padding:12px; background:rgba(255,255,255,0.02); border-radius:10px; border-left:3px solid ${color === 'blue' ? '#0070f3' : '#10b981'}`;
                div.innerHTML = msg;
                content.appendChild(div);
                content.scrollTop = content.scrollHeight;
            }

            bindEvents() {
                document.getElementById('cmd-input').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        const val = e.target.value;
                        if (val.includes('분석')) this.triggerAction('Data Fetcher', '매출 데이터 분석');
                        if (val.includes('알림')) this.triggerAction('Slack Notifier', '팀 채널 보고');
                        e.target.value = '';
                    }
                });
            }

            animate() {
                requestAnimationFrame(() => this.animate());
                this.nodes.forEach(n => {
                    n.rotation.y += n.userData.status === 'PROCESSING' ? 0.05 : 0.01;
                    n.position.y += Math.sin(Date.now()*0.002 + n.userData.offset) * 0.005;
                });
                this.renderer.render(this.scene, this.camera);
            }
        }

        const engine = new SnapEngine();
        window.onresize = () => {
            engine.camera.aspect = engine.container.clientWidth / engine.container.clientHeight;
            engine.camera.updateProjectionMatrix();
            engine.renderer.setSize(engine.container.clientWidth, engine.container.clientHeight);
        };
    </script>
</body>
</html>
